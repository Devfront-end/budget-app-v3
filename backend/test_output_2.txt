
> smart-budget-backend@1.0.0 test
> jest --coverage transaction.test.ts --verbose

  console.log
    =================================================================

      at Function.log [as sendVerificationEmail] (src/services/email.service.ts:61:21)

  console.log
    ðŸ“§ [MOCK EMAIL] Verification for: trans-test@example.com

      at Function.log [as sendVerificationEmail] (src/services/email.service.ts:62:21)

  console.log
    ðŸ”— Link: http://localhost:3000/api/v1/auth/verify-email?token=a3878bfe56d63dd45669dacbb1722b724efab7c2395050e77047071e13c6ea10

      at Function.log [as sendVerificationEmail] (src/services/email.service.ts:63:21)

  console.log
    =================================================================

      at Function.log [as sendVerificationEmail] (src/services/email.service.ts:64:21)

02:48:17 [[32minfo[39m]: [MOCK EMAIL] Verification link for trans-test@example.com: http://localhost:3000/api/v1/auth/verify-email?token=a3878bfe56d63dd45669dacbb1722b724efab7c2395050e77047071e13c6ea10 {
  "service": "smart-budget-api"
}
02:48:17 [[32minfo[39m]: [object Object] {
  "service": "smart-budget-api"
}
02:48:18 [[32minfo[39m]: User logged in: trans-test@example.com {
  "service": "smart-budget-api"
}
02:48:18 [[32minfo[39m]: [object Object] {
  "service": "smart-budget-api"
}
02:48:18 [[32minfo[39m]: Category created: 8fe10b82-e9af-43b1-8a24-0a516618bb75 by user ec8cf883-f710-4795-bc9e-663afdadb0eb {
  "service": "smart-budget-api"
}
02:48:18 [[32minfo[39m]: [object Object] {
  "service": "smart-budget-api"
}
02:48:18 [[32minfo[39m]: [object Object] {
  "service": "smart-budget-api"
}
02:48:18 [[32minfo[39m]: Transaction created: 86e7172c-65e4-4915-8e1d-c9e24c7be04f by user ec8cf883-f710-4795-bc9e-663afdadb0eb {
  "service": "smart-budget-api"
}
02:48:18 [[32minfo[39m]: [object Object] {
  "service": "smart-budget-api"
}
02:48:18 [[32minfo[39m]: [object Object] {
  "service": "smart-budget-api"
}
02:48:18 [[32minfo[39m]: [object Object] {
  "service": "smart-budget-api"
}
02:48:18 [[32minfo[39m]: Transaction updated: 86e7172c-65e4-4915-8e1d-c9e24c7be04f by user ec8cf883-f710-4795-bc9e-663afdadb0eb {
  "service": "smart-budget-api"
}
02:48:18 [[32minfo[39m]: [object Object] {
  "service": "smart-budget-api"
}
02:48:18 [[32minfo[39m]: [object Object] {
  "service": "smart-budget-api"
}
02:48:18 [[32minfo[39m]: Transaction deleted: 86e7172c-65e4-4915-8e1d-c9e24c7be04f by user ec8cf883-f710-4795-bc9e-663afdadb0eb {
  "service": "smart-budget-api"
}
02:48:18 [[32minfo[39m]: [object Object] {
  "service": "smart-budget-api"
}
02:48:18 [[32minfo[39m]: [object Object] {
  "service": "smart-budget-api"
}
FAIL src/__tests__/transaction.test.ts
  Transaction API
    âœ• should create a transaction linked to category and account (30 ms)
    âœ“ should fetch transactions (19 ms)
    âœ• should update a transaction (35 ms)
    âœ“ should delete a transaction (15 ms)

  â— Transaction API â€º should create a transaction linked to category and account

    expect(received).toBe(expected) // Object.is equality

    Expected: 50
    Received: "50"

      91 |         expect(res.status).toBe(201);
      92 |         expect(res.body.success).toBe(true);
    > 93 |         expect(res.body.data.transaction.amount).toBe(50);
         |                                                  ^
      94 |         expect(res.body.data.transaction.categoryId).toBe(categoryId);
      95 |     });
      96 |

      at Object.<anonymous> (src/__tests__/transaction.test.ts:93:50)

  â— Transaction API â€º should update a transaction

    expect(received).toBe(expected) // Object.is equality

    Expected: 75
    Received: "75"

      121 |
      122 |         expect(res.status).toBe(200);
    > 123 |         expect(res.body.data.transaction.amount).toBe(75);
          |                                                  ^
      124 |     });
      125 |
      126 |     it('should delete a transaction', async () => {

      at Object.<anonymous> (src/__tests__/transaction.test.ts:123:50)

-----------------------------|---------|----------|---------|---------|---------------------------------------------------
File                         | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s                                 
-----------------------------|---------|----------|---------|---------|---------------------------------------------------
All files                    |   39.85 |    16.47 |   21.68 |   40.13 |                                                   
 src                         |   95.91 |       50 |       0 |   95.91 |                                                   
  app.ts                     |   95.91 |       50 |       0 |   95.91 | 60,85                                             
 src/config                  |    62.5 |        0 |       0 |    62.5 |                                                   
  database.ts                |    62.5 |        0 |       0 |    62.5 | 14-16                                             
 src/controllers             |   20.29 |    11.73 |   15.15 |   20.72 |                                                   
  ai.controller.ts           |      15 |        0 |       0 |      15 | 7-48                                              
  analytics.controller.ts    |   17.64 |        0 |       0 |   17.64 | 7-59                                              
  auth.controller.ts         |   26.57 |     7.14 |   27.27 |   27.14 | 24,95-133,148,156,164,178-189,197-213,272-500     
  bankAccount.controller.ts  |   17.77 |    26.66 |   16.66 |   17.77 | 7-20,49-152                                       
  budget.controller.ts       |    3.52 |        0 |       0 |    3.61 | 7-314                                             
  category.controller.ts     |   37.03 |       50 |      25 |   37.03 | 7-21,51-97                                        
  dashboard.controller.ts    |    7.27 |        0 |       0 |     7.4 | 7-174                                             
  debtRatio.controller.ts    |    8.33 |        0 |       0 |    8.82 | 8-95                                              
  paymentPlan.controller.ts  |    9.37 |        0 |       0 |    9.37 | 7-98                                              
  subscription.controller.ts |       6 |        0 |       0 |       6 | 7-177                                             
  transaction.controller.ts  |   67.69 |    48.14 |     100 |   73.33 | 16-18,46-47,71-77,110-111,129,156-157,174,189-190 
  wishlist.controller.ts     |    7.31 |        0 |       0 |    7.31 | 7-137                                             
 src/middleware              |   70.45 |       25 |   71.42 |   66.66 |                                                   
  auth.ts                    |   72.22 |     62.5 |     100 |   70.58 | 33-34,55-56,68                                    
  errorHandler.ts            |   42.85 |        0 |       0 |   33.33 | 11-21                                             
  requestLogger.ts           |     100 |      100 |     100 |     100 |                                                   
  validate.ts                |   63.63 |        0 |   66.66 |   55.55 | 9-22                                              
 src/routes                  |     100 |      100 |     100 |     100 |                                                   
  ai.routes.ts               |     100 |      100 |     100 |     100 |                                                   
  analytics.routes.ts        |     100 |      100 |     100 |     100 |                                                   
  auth.routes.ts             |     100 |      100 |     100 |     100 |                                                   
  bankAccount.routes.ts      |     100 |      100 |     100 |     100 |                                                   
  budget.routes.ts           |     100 |      100 |     100 |     100 |                                                   
  category.routes.ts         |     100 |      100 |     100 |     100 |                                                   
  dashboard.routes.ts        |     100 |      100 |     100 |     100 |                                                   
  debtRatio.routes.ts        |     100 |      100 |     100 |     100 |                                                   
  paymentPlan.routes.ts      |     100 |      100 |     100 |     100 |                                                   
  subscription.routes.ts     |     100 |      100 |     100 |     100 |                                                   
  transaction.routes.ts      |     100 |      100 |     100 |     100 |                                                   
  wishlist.routes.ts         |     100 |      100 |     100 |     100 |                                                   
 src/schemas                 |     100 |      100 |     100 |     100 |                                                   
  auth.schema.ts             |     100 |      100 |     100 |     100 |                                                   
 src/services                |      25 |    29.03 |   33.33 |   25.33 |                                                   
  ai.service.ts              |   14.63 |     6.66 |      25 |      15 | 15-141                                            
  email.service.ts           |   37.14 |       50 |      50 |   37.14 | 16-49,69-85                                       
 src/utils                   |     100 |      100 |     100 |     100 |                                                   
  logger.ts                  |     100 |      100 |     100 |     100 |                                                   
-----------------------------|---------|----------|---------|---------|---------------------------------------------------
Test Suites: 1 failed, 1 total
Tests:       2 failed, 2 passed, 4 total
Snapshots:   0 total
Time:        5.346 s
Ran all test suites matching /transaction.test.ts/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
